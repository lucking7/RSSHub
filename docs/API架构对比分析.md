# API æ¶æ„å¯¹æ¯”åˆ†æ

## ğŸ¯ ä¸‰ä¸ªé¡¹ç›®çš„å®šä½

### ğŸ“Š é¡¹ç›®å¯¹æ¯”è¡¨

| é¡¹ç›® | ç›®å½• | ä¸»è¦åŠŸèƒ½ | æŠ€æœ¯æ ˆ | æ•°æ®æº |
|------|------|----------|--------|--------|
| **webstock-pywencai** | `/webstock-main/stock/pywencai` | Pythonå°è£…çš„é—®è´¢APIåº“ | Python, requests, pandas | é—®è´¢ç½‘ |
| **Bull-iWenCai** | `/Bull-main/src/iWenCai` | è‚¡ç¥¨æ•°æ®é‡‡é›†ç³»ç»Ÿ | Python, MySQL | é—®è´¢ç½‘ |
| **Bull-kaipanla** | `/Bull-main/src/kaipanla` | æ¶¨åœæ¿æ•°æ®é‡‡é›† | Python, MySQL | å¼€ç›˜å•¦App |
| **webstock-api** | `/webstock-main/stock/stock-api` | Django RESTåç«¯ | Django, MySQL | ç»¼åˆæ•°æ® |

---

## ğŸ”„ æ•°æ®æµè½¬æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å¤–éƒ¨æ•°æ®æº                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é—®è´¢ç½‘ API             å¼€ç›˜å•¦ API            ä¸œè´¢ API           â”‚
â”‚  (iwencai.com)         (longhuvip.com)      (eastmoney.com)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                       â”‚
         â–¼                    â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®é‡‡é›†å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  pywencaiåº“            kaipanlaAPI           akshareåº“          â”‚
â”‚  iWenCaiApiç±»          kaipanlaDataMgr      (ç¬¬ä¸‰æ–¹åº“)           â”‚
â”‚  â€¢ è‚¡ç¥¨æ—¥è¡Œæƒ…           â€¢ æ¶¨åœ/ç‚¸æ¿æ•°æ®        â€¢ å¸‚åœºæ•°æ®          â”‚
â”‚  â€¢ æ¿å—æ•°æ®             â€¢ å¸‚åœºæˆäº¤é‡          â€¢ é¾™è™æ¦œ            â”‚
â”‚  â€¢ è´¢åŠ¡æ•°æ®             â€¢ æŒ‡æ•°æ•°æ®            â€¢ å¤§å®—äº¤æ˜“          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                       â”‚
         â–¼                    â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        æ•°æ®å­˜å‚¨å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        MySQL æ•°æ®åº“                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ è‚¡ç¥¨åŸºç¡€è¡¨    â”‚  â”‚ æ¶¨åœæ•°æ®è¡¨    â”‚  â”‚ å¼€ç›˜å•¦æ•°æ®è¡¨  â”‚         â”‚
â”‚  â”‚ stock_info   â”‚  â”‚ stock_zt_nameâ”‚  â”‚ kaipanla_*   â”‚         â”‚
â”‚  â”‚ stock_zh_ah  â”‚  â”‚ stock_buy    â”‚  â”‚              â”‚         â”‚
â”‚  â”‚ stock_industryâ”‚ â”‚ stock_config â”‚  â”‚              â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸šåŠ¡é€»è¾‘å±‚ (Service)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  StockBasicService                                              â”‚
â”‚  â€¢ filter_stocks() - æ ¹æ®æ¶¨åœåŸºå› ç­›é€‰                            â”‚
â”‚  â€¢ select_by_ticai() - æŒ‰é¢˜æé€‰è‚¡                                â”‚
â”‚  â€¢ query_stock_zt_by_condition() - æ¶¨åœè‚¡æŸ¥è¯¢                    â”‚
â”‚  â€¢ query_market_qx() - å¸‚åœºæƒ…ç»ªåˆ†æ                              â”‚
â”‚  â€¢ query_daily() - æ¯æ—¥å¸‚åœºæ•°æ®                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       API æ¥å£å±‚ (Django)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  REST API ç«¯ç‚¹:                                                  â”‚
â”‚  â€¢ /stock/stock_ah - è‚¡ç¥¨åŸºç¡€æ•°æ®                                â”‚
â”‚  â€¢ /stock/stock_zt - æ¶¨åœè‚¡æŸ¥è¯¢                                  â”‚
â”‚  â€¢ /stock/select - é¢˜æé€‰è‚¡                                      â”‚
â”‚  â€¢ /stock/buy - ä¹°å…¥ç®¡ç†                                         â”‚
â”‚  â€¢ /stock/daily - å¸‚åœºæ•°æ®                                       â”‚
â”‚  â€¢ /stock/config - é…ç½®ç®¡ç†                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         å‰ç«¯åº”ç”¨                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Vue.js Admin (stock-admin)                                     â”‚
â”‚  â€¢ æ•°æ®å±•ç¤º                                                      â”‚
â”‚  â€¢ é€‰è‚¡å·¥å…·                                                      â”‚
â”‚  â€¢ ç­–ç•¥é…ç½®                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ ä¸¤ä¸ªé—®è´¢å®ç°çš„å¯¹æ¯”

### 1ï¸âƒ£ pywencai (webstock)

**ç‰¹ç‚¹**:
- âœ… é€šç”¨Pythonåº“
- âœ… APIå°è£…å®Œæ•´
- âœ… æ”¯æŒè‡ªç„¶è¯­è¨€æŸ¥è¯¢
- âœ… è‡ªåŠ¨åˆ†é¡µ
- âœ… æ•°æ®è¿”å›DataFrameæ ¼å¼

**ä»£ç ç»“æ„**:
```
pywencai/
â”œâ”€â”€ __init__.py          # å¯¼å‡ºæ¥å£
â”œâ”€â”€ wencai.py            # æ ¸å¿ƒAPI
â”œâ”€â”€ headers.py           # è¯·æ±‚å¤´ç”Ÿæˆ
â”œâ”€â”€ convert.py           # æ•°æ®è½¬æ¢
â””â”€â”€ hexin-v.bundle.js    # Tokenç”Ÿæˆ
```

**æ ¸å¿ƒAPI**:
```python
# 1. get_robot_data() - è·å–æŸ¥è¯¢æ¡ä»¶
# 2. get_page() - è·å–å•é¡µæ•°æ®
# 3. loop_page() - å¾ªç¯è·å–æ‰€æœ‰é¡µ
# 4. get() - ç»Ÿä¸€å…¥å£
```

**ä¼˜åŠ¿**:
- ğŸ¯ æ˜“äºä½¿ç”¨ï¼Œä¸€è¡Œä»£ç å³å¯æŸ¥è¯¢
- ğŸ¯ è‡ªåŠ¨å¤„ç†åˆ†é¡µå’Œé‡è¯•
- ğŸ¯ ç›´æ¥è¿”å›pandas DataFrame

**ä½¿ç”¨ç¤ºä¾‹**:
```python
import pywencai

# ç®€å•æŸ¥è¯¢
df = pywencai.get(query='æ¶¨åœè‚¡', loop=True)

# å¸¦å‚æ•°æŸ¥è¯¢
df = pywencai.get(
    query='é‡æ¯”ä»å¤§åˆ°å°æ’åå‰50',
    retry=10,
    sleep=1,
    log=True
)
```

### 2ï¸âƒ£ iWenCaiApi (Bull)

**ç‰¹ç‚¹**:
- âœ… é¢å‘å¯¹è±¡è®¾è®¡
- âœ… æ•°æ®åº“é›†æˆ
- âœ… Cookieç®¡ç†
- âœ… ä¸“é—¨çš„æ•°æ®é‡‡é›†ç±»

**ä»£ç ç»“æ„**:
```
iWenCai/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ iWenCaiApi.py            # æ ¸å¿ƒAPIç±»
â”œâ”€â”€ getHexinV.py             # Tokenç”Ÿæˆ
â”œâ”€â”€ FetchStockDailyData.py   # è‚¡ç¥¨æ—¥è¡Œæƒ…
â”œâ”€â”€ FetchBanKuaiData.py      # æ¿å—æ•°æ®
â”œâ”€â”€ FetchZhaBanData.py       # ç‚¸æ¿æ•°æ®
â”œâ”€â”€ FetchVMAData.py          # VMAæ•°æ®
â””â”€â”€ ... (å…¶ä»–é‡‡é›†æ¨¡å—)
```

**æ ¸å¿ƒç±»**:
```python
# 1. CIWenCaiAPI - é—®è´¢APIå°è£…
#    - RequestFirstData()     # é¦–æ¬¡è¯·æ±‚
#    - RequestOnePage()       # å•é¡µè¯·æ±‚
#    - RequestAllPagesData()  # æ‰€æœ‰é¡µ

# 2. CFetchStockDailyData - è‚¡ç¥¨æ—¥è¡Œæƒ…
# 3. CFetchBanKuaiData - æ¿å—æ•°æ®
# 4. CFetchZhaBanData - ç‚¸æ¿æ•°æ®
```

**ä¼˜åŠ¿**:
- ğŸ¯ ä¸“ä¸šåŒ–æ•°æ®é‡‡é›†
- ğŸ¯ ç›´æ¥å­˜å‚¨åˆ°æ•°æ®åº“
- ğŸ¯ Cookieè‡ªåŠ¨ç®¡ç†
- ğŸ¯ æ•°æ®æ ¼å¼åŒ–å¤„ç†

**ä½¿ç”¨ç¤ºä¾‹**:
```python
from iWenCai.FetchStockDailyData import CFetchStockDailyData

# åˆ›å»ºé‡‡é›†å™¨
fetcher = CFetchStockDailyData(dbConnection, '2023-04-27')

# é‡‡é›†å¹¶å­˜å‚¨
df = fetcher.RequestAllPagesDataAndWriteToDB(perPage=100)
```

### ğŸ”„ ä¸¤è€…å¯¹æ¯”æ€»ç»“

| ç‰¹æ€§ | pywencai | iWenCaiApi |
|------|----------|------------|
| **è®¾è®¡ç†å¿µ** | é€šç”¨åº“ | ä¸“ç”¨ç³»ç»Ÿ |
| **ä½¿ç”¨æ–¹å¼** | å‡½æ•°è°ƒç”¨ | ç±»å®ä¾‹åŒ– |
| **æ•°æ®å­˜å‚¨** | è¿”å›DataFrame | ç›´æ¥å†™æ•°æ®åº“ |
| **Cookieç®¡ç†** | æ‰‹åŠ¨ä¼ å…¥ | æ•°æ®åº“å­˜å‚¨ |
| **é”™è¯¯å¤„ç†** | é‡è¯•æœºåˆ¶ | é‡è¯•+æ—¥å¿— |
| **æ‰©å±•æ€§** | ä¸€èˆ¬ | å¼º |
| **å­¦ä¹ æˆæœ¬** | ä½ | ä¸­ |
| **é€‚ç”¨åœºæ™¯** | å¿«é€ŸæŸ¥è¯¢ | ç³»ç»Ÿé›†æˆ |

**æ¨èä½¿ç”¨åœºæ™¯**:
- **pywencai**: é€‚åˆå¿«é€ŸæŸ¥è¯¢ã€æ•°æ®åˆ†æã€Jupyter Notebook
- **iWenCaiApi**: é€‚åˆå®šæ—¶ä»»åŠ¡ã€ç³»ç»Ÿé›†æˆã€æ•°æ®é‡‡é›†ç³»ç»Ÿ

---

## ğŸ¯ å¼€ç›˜å•¦ API ç‹¬ç‰¹æ€§

### æ•°æ®ä¼˜åŠ¿

å¼€ç›˜å•¦APIæä¾›çš„ç‹¬ç‰¹æ•°æ®:

1. **æ¶¨åœæ¿ç»†èŠ‚**:
   - âœ… é¦–æ¬¡æ¶¨åœæ—¶é—´ (ç²¾ç¡®åˆ°ç§’)
   - âœ… æœ€åæ¶¨åœæ—¶é—´
   - âœ… ç‚¸æ¿æ—¶é—´
   - âœ… å°å•å˜åŒ– (æœ€å¤§å°å•/å½“å‰å°å•)
   - âœ… æ¶¨åœåŸå›  (å¼€ç›˜å•¦ç‰¹æœ‰)

2. **å¸‚åœºé‡èƒ½**:
   - âœ… å®æ—¶æˆäº¤é‡
   - âœ… ä¸æ˜¨æ—¥å¯¹æ¯”
   - âœ… é‡èƒ½è¶‹åŠ¿å›¾æ•°æ®

3. **æ¶¨è·Œåœç»Ÿè®¡**:
   - âœ… å®é™…æ¶¨åœæ•° (vs ç†è®ºæ¶¨åœ)
   - âœ… å®é™…è·Œåœæ•°
   - âœ… æŒ‰æ¿å—åˆ†ç±»

### ä¸é—®è´¢çš„å·®å¼‚

| æ•°æ®ç±»å‹ | é—®è´¢ | å¼€ç›˜å•¦ | æ¨èæ¥æº |
|----------|------|--------|----------|
| è‚¡ç¥¨æ—¥è¡Œæƒ… | âœ… | âŒ | é—®è´¢ |
| æ¿å—æ•°æ® | âœ… | âŒ | é—®è´¢ |
| è´¢åŠ¡æ•°æ® | âœ… | âŒ | é—®è´¢ |
| æ¶¨åœæ—¶é—´ | âŒ | âœ… | å¼€ç›˜å•¦ |
| å°å•æ•°æ® | âŒ | âœ… | å¼€ç›˜å•¦ |
| ç‚¸æ¿æ—¶é—´ | âŒ | âœ… | å¼€ç›˜å•¦ |
| å¸‚åœºé‡èƒ½ | éƒ¨åˆ† | âœ… | å¼€ç›˜å•¦ |
| æ¶¨åœåŸå›  | âœ… | âœ… | ä¸¤è€…ç»“åˆ |

---

## ğŸ—ï¸ Django REST API æ¶æ„

### åˆ†å±‚è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   urls.py                        â”‚
â”‚              (è·¯ç”±é…ç½®å±‚)                          â”‚
â”‚  /stock/stock_ah    â†’ stock_ah()                â”‚
â”‚  /stock/stock_zt    â†’ stock_zt()                â”‚
â”‚  /stock/select      â†’ query_by_ticai()          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   views.py                       â”‚
â”‚             (æ§åˆ¶å™¨å±‚ - è¯·æ±‚å¤„ç†)                  â”‚
â”‚  â€¢ å‚æ•°éªŒè¯ (@request_verify)                    â”‚
â”‚  â€¢ è°ƒç”¨Serviceå±‚                                 â”‚
â”‚  â€¢ è¿”å›HttpResponseVo                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  service.py                      â”‚
â”‚              (ä¸šåŠ¡é€»è¾‘å±‚)                          â”‚
â”‚  StockBasicService:                             â”‚
â”‚    â€¢ filter_stocks()      - è‚¡ç¥¨ç­›é€‰            â”‚
â”‚    â€¢ select_by_ticai()    - é¢˜æé€‰è‚¡            â”‚
â”‚    â€¢ query_stock_zt_*()   - æ¶¨åœæŸ¥è¯¢            â”‚
â”‚    â€¢ query_market_qx()    - å¸‚åœºåˆ†æ            â”‚
â”‚    â€¢ query_daily()        - æ¯æ—¥æ•°æ®            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  models.py                       â”‚
â”‚               (æ•°æ®æ¨¡å‹å±‚)                         â”‚
â”‚  â€¢ StockAhModel      - ä¸œè´¢è‚¡ç¥¨                  â”‚
â”‚  â€¢ StockZTModel      - æ¶¨åœæ•°æ®                  â”‚
â”‚  â€¢ StockBuyModel     - ä¹°å…¥è®°å½•                  â”‚
â”‚  â€¢ StockModel        - è‚¡ç¥¨åŸºå›                   â”‚
â”‚  â€¢ ConfigModel       - é…ç½®                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                MySQL æ•°æ®åº“                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒè®¾è®¡æ¨¡å¼

#### 1. è¯·æ±‚éªŒè¯è£…é¥°å™¨
```python
@request_verify("post", cls=CheckRequestParam,
    configs=[
        CheckConfig(name="Filter", is_null=True, p_type=list),
        CheckConfig(name="Sort", is_null=True, p_type=str),
        CheckConfig(name="Offset", p_type=int, default=0),
        CheckConfig(name="Limit", p_type=int, default=20)
    ])
def stock_ah(request):
    # è‡ªåŠ¨éªŒè¯å‚æ•°
    data_list, total = service.query_stock_ah_by_condition(request.params)
    return HttpResponseVo(response, status=200)
```

#### 2. ç»Ÿä¸€å“åº”æ ¼å¼
```python
class HttpResponseVo:
    def __init__(self, data=None, status=200):
        self.data = data
        self.status = status
```

#### 3. Serviceå±‚å¤ç”¨
```python
class ServiceBase:
    def create_query_by_condition_sql(self, params, columns, table):
        # é€šç”¨SQLæ„å»º
        pass
    
    def query_count_by_sql(self, sql):
        # é€šç”¨è®¡æ•°æŸ¥è¯¢
        pass
```

---

## ğŸ”§ æŠ€æœ¯å®ç°å¯¹æ¯”

### Tokenç”Ÿæˆæœºåˆ¶

#### pywencaiæ–¹å¼
```python
# headers.py
def get_token():
    result = subprocess.run(
        ['node', 'hexin-v.bundle.js'], 
        stdout=subprocess.PIPE
    )
    return result.stdout.decode().strip()
```

#### Bullæ–¹å¼
```python
# getHexinV.py
from iWenCai.getHexinV import get_hexin_v
v = get_hexin_v()  # è°ƒç”¨hexin_v.js
```

**å¯¹æ¯”**:
- pywencai: ä½¿ç”¨æ‰“åŒ…åçš„bundle.js
- Bull: ä½¿ç”¨åŸå§‹jsæ–‡ä»¶
- æœ¬è´¨: éƒ½æ˜¯é€šè¿‡Node.jsæ‰§è¡ŒJSä»£ç 

### æ•°æ®è½¬æ¢å¤„ç†

#### pywencaiæ–¹å¼
```python
# convert.py
def convert(res):
    result = json.loads(res.text)
    components = content['components']
    
    # è‡ªåŠ¨è¯†åˆ«è¿”å›ç±»å‹
    if show_type == 'xuangu_tableV1':
        # é€‰è‚¡è¡¨æ ¼
    elif show_type == 'dragon_tiger_stock':
        # é¾™è™æ¦œ
    # ... å…¶ä»–ç±»å‹
```

#### Bullæ–¹å¼
```python
# iWenCaiApi.py
def RequestOnePage(self, perPage, page):
    response = requests.request("POST", url, ...)
    js = json.loads(response.text)
    datas = js["answer"]["components"][0]["data"]["datas"]
    return datas  # ç›´æ¥è¿”å›æ•°æ®æ•°ç»„
```

**å¯¹æ¯”**:
- pywencai: æ™ºèƒ½è§£æï¼Œæ”¯æŒå¤šç§è¿”å›æ ¼å¼
- Bull: ç®€å•ç›´æ¥ï¼Œåªå¤„ç†æ ‡å‡†æ ¼å¼

### åˆ†é¡µå®ç°

#### pywencaiæ–¹å¼
```python
def loop_page(loop, row_count, **kwargs):
    perpage = kwargs.pop('perpage', 100)
    max_page = math.ceil(row_count / perpage)
    
    while can_loop(loop_count, count):
        kwargs['page'] = initPage + count
        resultPage = get_page(**kwargs)
        result = pd.concat([result, resultPage])
    
    return result
```

#### Bullæ–¹å¼
```python
def RequestAllPagesData(self, payload, perPage=100):
    pages = math.ceil(self.allDataCount / perPage)
    
    for i in range(1, pages+1):
        datas = self.RequestOnePage(perPage, i)
        allDatas.extend(datas)
    
    return pd.DataFrame(allDatas)
```

**å¯¹æ¯”**:
- pywencai: æ”¯æŒå¾ªç¯æ¬¡æ•°é™åˆ¶
- Bull: å…¨é‡è·å–æ‰€æœ‰é¡µ

---

## ğŸ’¡ æœ€ä½³å®è·µå»ºè®®

### 1. æ•°æ®é‡‡é›†

**æ¨èæ¶æ„**:
```
å®šæ—¶ä»»åŠ¡
â”œâ”€â”€ é—®è´¢æ•°æ®é‡‡é›† (ä½¿ç”¨iWenCaiApi)
â”‚   â”œâ”€â”€ è‚¡ç¥¨æ—¥è¡Œæƒ…
â”‚   â”œâ”€â”€ æ¿å—æ•°æ®
â”‚   â””â”€â”€ è´¢åŠ¡æ•°æ®
â”‚
â”œâ”€â”€ å¼€ç›˜å•¦æ•°æ®é‡‡é›† (ä½¿ç”¨kaipanlaAPI)
â”‚   â”œâ”€â”€ æ¶¨åœæ¿æ•°æ®
â”‚   â”œâ”€â”€ å¸‚åœºé‡èƒ½
â”‚   â””â”€â”€ æŒ‡æ•°æ•°æ®
â”‚
â””â”€â”€ å­˜å‚¨åˆ°MySQL
```

### 2. æ•°æ®æŸ¥è¯¢

**æ¨èæ¶æ„**:
```
å¿«é€ŸæŸ¥è¯¢ â†’ ä½¿ç”¨pywencai (Jupyter Notebook)
ç³»ç»ŸæŸ¥è¯¢ â†’ ä½¿ç”¨Django REST API
å®æ—¶æ•°æ® â†’ ç›´æ¥è°ƒç”¨API + ç¼“å­˜
```

### 3. æ•°æ®æ›´æ–°é¢‘ç‡

| æ•°æ®ç±»å‹ | æ›´æ–°é¢‘ç‡ | æ•°æ®æº |
|----------|----------|--------|
| è‚¡ç¥¨æ—¥è¡Œæƒ… | æ¯æ—¥æ”¶ç›˜å | é—®è´¢ |
| æ¶¨åœæ¿æ•°æ® | æ¯æ—¥æ”¶ç›˜å | å¼€ç›˜å•¦ |
| æ¿å—æ•°æ® | æ¯æ—¥æ”¶ç›˜å | é—®è´¢ |
| å¸‚åœºé‡èƒ½ | å®æ—¶/æ¯æ—¥ | å¼€ç›˜å•¦ |
| è´¢åŠ¡æ•°æ® | æ¯å­£åº¦ | é—®è´¢ |

### 4. æ€§èƒ½ä¼˜åŒ–

**ç¼“å­˜ç­–ç•¥**:
```python
# 1. æ•°æ®åº“æŸ¥è¯¢ç¼“å­˜
@cache_result(ttl=300)  # 5åˆ†é’Ÿç¼“å­˜
def query_stock_zt_by_condition(params):
    pass

# 2. APIè°ƒç”¨ç¼“å­˜
@cache_result(ttl=60)  # 1åˆ†é’Ÿç¼“å­˜
def get_market_data():
    pass

# 3. é…ç½®ç¼“å­˜
@cache_result(ttl=3600)  # 1å°æ—¶ç¼“å­˜
def get_config():
    pass
```

---

## ğŸ“ å­¦ä¹ è·¯å¾„å»ºè®®

### åˆå­¦è€…
1. ä»pywencaiå¼€å§‹ï¼Œå­¦ä¹ åŸºæœ¬æŸ¥è¯¢
2. ç†è§£é—®è´¢çš„è‡ªç„¶è¯­è¨€æŸ¥è¯¢
3. æŒæ¡pandasæ•°æ®å¤„ç†

### è¿›é˜¶å¼€å‘è€…
1. å­¦ä¹ iWenCaiApiçš„é¢å‘å¯¹è±¡è®¾è®¡
2. ç†è§£kaipanlaAPIçš„åˆ†é¡µæœºåˆ¶
3. æŒæ¡Django RESTæ¡†æ¶

### ç³»ç»Ÿæ¶æ„å¸ˆ
1. ç†è§£æ•´ä½“æ•°æ®æµè½¬
2. è®¾è®¡åˆç†çš„ç¼“å­˜ç­–ç•¥
3. ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

---

## ğŸ“Š åŠŸèƒ½çŸ©é˜µ

| åŠŸèƒ½ | pywencai | iWenCaiApi | kaipanlaAPI | Django API |
|------|----------|------------|-------------|------------|
| è‚¡ç¥¨æŸ¥è¯¢ | âœ… | âœ… | âŒ | âœ… |
| æ¿å—æ•°æ® | âœ… | âœ… | âŒ | âœ… |
| æ¶¨åœæ•°æ® | âœ… | âœ… | âœ… | âœ… |
| æ¶¨åœæ—¶é—´ | âŒ | âŒ | âœ… | âœ… |
| å¸‚åœºé‡èƒ½ | éƒ¨åˆ† | éƒ¨åˆ† | âœ… | âœ… |
| æ•°æ®å­˜å‚¨ | âŒ | âœ… | âœ… | âœ… |
| REST API | âŒ | âŒ | âŒ | âœ… |
| é¢˜æé€‰è‚¡ | âŒ | âŒ | âŒ | âœ… |
| ç­–ç•¥é…ç½® | âŒ | âŒ | âŒ | âœ… |

---

## ğŸ”® æœªæ¥æ”¹è¿›å»ºè®®

### 1. æ•°æ®é‡‡é›†å±‚
- [ ] ç»Ÿä¸€é‡‡é›†æ¥å£
- [ ] å¢åŠ æ›´å¤šæ•°æ®æº
- [ ] å®ç°å¢é‡æ›´æ–°
- [ ] æ·»åŠ æ•°æ®è´¨é‡æ£€æŸ¥

### 2. å­˜å‚¨å±‚
- [ ] å¼•å…¥æ—¶åºæ•°æ®åº“ (InfluxDB)
- [ ] å®ç°è¯»å†™åˆ†ç¦»
- [ ] æ·»åŠ æ•°æ®å½’æ¡£
- [ ] ä¼˜åŒ–ç´¢å¼•ç­–ç•¥

### 3. APIå±‚
- [ ] æ·»åŠ GraphQLæ”¯æŒ
- [ ] å®ç°WebSocketæ¨é€
- [ ] å¢åŠ APIé™æµ
- [ ] å®Œå–„APIæ–‡æ¡£

### 4. ä¸šåŠ¡å±‚
- [ ] å¢åŠ æ›´å¤šé€‰è‚¡ç­–ç•¥
- [ ] å®ç°å›æµ‹åŠŸèƒ½
- [ ] æ·»åŠ é£é™©è¯„ä¼°
- [ ] ä¼˜åŒ–ç®—æ³•æ€§èƒ½

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**ç”Ÿæˆæ—¶é—´**: 2025-10-21

