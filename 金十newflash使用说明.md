# 金十数据 newflash 路由使用说明

## ✅ 已修复的问题

### 1. 参数跳过问题
**问题**：之前无法跳过 channel 参数直接查看重要快讯
**解决方案**：现在同时支持路径参数和查询参数（推荐）

### 2. 图片显示问题
**说明**：路由已正确支持图片显示，但金十数据 API 返回的大部分快讯本身就不包含图片
**原因**：这是数据源特性，只有少数深度文章和特殊快讯才会带配图

---

## 📖 使用方式

### 方式一：查询参数（推荐）✅

查询参数方式更灵活，可以任意组合，无需按顺序填写。

#### 基础示例
```
/jin10/newflash                           # 所有快讯
/jin10/newflash?important=1               # ✅ 只看重要快讯（无需跳过channel）
/jin10/newflash?channel=4                 # 只看A股
/jin10/newflash?type=2                    # 只看深度文章
```

#### 组合示例
```
/jin10/newflash?channel=4&important=1     # A股重要快讯
/jin10/newflash?channel=3&type=0&important=1  # 全球市场重要快讯（非深度）
/jin10/newflash?channel=1&important=1     # 外汇/贵金属重要快讯
/jin10/newflash?type=2&important=1        # 所有重要的深度文章
```

### 方式二：路径参数（向后兼容）

```
/jin10/newflash                           # 所有快讯
/jin10/newflash/3                         # 全球市场快讯
/jin10/newflash/4/0/1                     # A股重要快讯
/jin10/newflash///1                       # ⚠️ 所有重要快讯（需要三个斜杠）
```

**注意**：路径参数方式要跳过前面的参数时需要使用多个 `/`，不太优雅，建议使用查询参数。

---

## 📝 参数说明

### channel（频道）
| 值 | 含义 |
|----|------|
| 1 | 外汇/贵金属 |
| 2 | 期货 |
| 3 | 全球市场 |
| 4 | A股 |
| 5 | 深度文章 |

### type（类型）
| 值 | 含义 |
|----|------|
| 0 | 普通快讯 |
| 2 | 深度文章 |

### important（重要性）
| 值 | 含义 |
|----|------|
| 1 | 只看重要快讯 |
| 空 | 所有快讯 |

---

## 🖼️ 关于图片显示

### 图片支持情况
- ✅ 路由已完整支持图片显示
- ✅ 模板已正确配置 `<img>` 标签
- ✅ 图片 URL 会自动从 API 获取

### 为什么看不到图片？
1. **数据源特性**：金十数据的快讯大多数是纯文本，只有少量内容包含图片
2. **图片类型分布**：
   - 普通快讯（type=0）：很少有图片（约 5%）
   - 深度文章（type=2）：更可能包含图片（约 30%）
   - 重要快讯：不一定有图片

### 如何看到带图片的快讯？
试试这些路由，更容易遇到带图片的内容：

```
/jin10/newflash?type=2           # 深度文章更可能有图
/jin10/newflash?channel=5        # 深度文章频道
/jin10/newflash?type=2&channel=4 # A股深度文章
```

### 图片显示示例
当 API 返回包含图片的快讯时，RSS 内容会自动显示：

```html
【快讯内容】

<img src="https://flash-scdn.jin10.com/xxx.jpg" alt="配图" style="max-width: 100%;">

📖 查看原文链接
📊 附加信息（如果有）
```

---

## 🎯 实用订阅场景

### 场景1：关注A股重要消息
```
/jin10/newflash?channel=4&important=1
```
**适合**：只关心A股，不想被其他市场信息干扰

### 场景2：看所有重要快讯
```
/jin10/newflash?important=1
```
**适合**：关注所有市场的重要动态

### 场景3：阅读深度分析文章
```
/jin10/newflash?type=2
```
**适合**：不要碎片化快讯，只看深度分析

### 场景4：外汇交易员专用
```
/jin10/newflash?channel=1&important=1
```
**适合**：外汇/贵金属交易者

### 场景5：全球市场所有动态
```
/jin10/newflash?channel=3
```
**适合**：宏观分析师、全球投资者

---

## 🔄 与普通接口对比

| 功能 | 普通接口 `/jin10` | 新版接口 `/jin10/newflash` |
|------|-------------------|---------------------------|
| 重要快讯筛选 | ✅ `/jin10/1` | ✅ `/jin10/newflash?important=1` |
| 频道分类 | ❌ 不支持 | ✅ 支持 5 种频道 |
| 内容类型筛选 | ❌ 不支持 | ✅ 区分快讯/深度文章 |
| 原文链接 | ❌ 只有金十锚点 | ✅ 优先使用原文链接 |
| 附加信息 | ❌ 不显示 | ✅ 显示图表/行情/相关链接 |
| 参数灵活性 | ⭐ | ⭐⭐⭐ |

---

## ⚙️ 技术细节

### API 数据结构
```json
{
  "id": "20251029121518107800",
  "time": "2025-10-29 12:15:18",
  "type": 0,                    // 0=快讯, 2=深度
  "important": 1,               // 0=普通, 1=重要
  "channel": [3, 4],           // 频道数组
  "data": {
    "pic": "https://...",      // 图片URL（可能为空）
    "content": "【标题】内容",
    "source": "央视新闻",
    "source_link": "https://..." // 原文链接
  },
  "remark": [                   // 附加信息
    {
      "type": "link",
      "data": {"url": "...", "title": "..."}
    }
  ]
}
```

### 参数处理优先级
```typescript
// 查询参数 > 路径参数
const channel = ctx.req.query('channel') || ctx.req.param('channel');
```

### 缓存策略
每个参数组合都有独立缓存：
```
jin10:newflash:all:all:all        # 所有快讯
jin10:newflash:4:all:1            # A股重要快讯
jin10:newflash:all:2:all          # 所有深度文章
```

---

## 🐛 故障排查

### 问题1：没有数据返回
**可能原因**：
- 参数值错误（如 channel=10，不存在的频道）
- 筛选条件太严格（如某个时间段没有符合条件的快讯）

**解决方案**：
- 检查参数值是否在有效范围内
- 先不加参数测试 `/jin10/newflash` 是否有数据

### 问题2：看不到图片
**原因**：大部分快讯本身没有图片（数据源特性）
**解决方案**：
- 尝试 `/jin10/newflash?type=2` 查看深度文章
- 等待一段时间，有图片的内容会陆续出现

### 问题3：原文链接失效
**原因**：部分快讯可能没有原文链接
**解决方案**：会自动回退到金十网站锚点链接

---

## 📞 技术支持

- GitHub: https://github.com/lucking7/RSSHub
- 最新提交: `68834a23a`
- 维护者: laampui

---

## 更新日志

### 2025-10-29
- ✅ 新增查询参数支持，解决参数跳过问题
- ✅ 完善文档说明图片显示机制
- ✅ 优化参数处理逻辑（查询参数优先）
