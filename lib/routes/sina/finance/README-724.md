# 新浪财经724接口 - 使用指南

## 🚀 快速开始

### 基础使用

```
GET /sina/finance/724
```

获取最新的财经快讯（默认20条）

### 带参数使用

```
GET /sina/finance/724?limit=50
GET /sina/finance/724/stock?limit=30
GET /sina/finance/724?num=30&limit=100
```

## 📖 参数说明

### 路径参数

| 参数 | 说明 | 可选值 | 默认值 |
|------|------|--------|--------|
| tag | 分类标签 | `all`（全部）<br>`macro`（宏观）<br>`stock`（股市）<br>`international`（国际）<br>`opinion`（观点） | `all` |

### 查询参数

| 参数 | 说明 | 范围 | 默认值 |
|------|------|------|--------|
| limit | 返回总数量 | 1-1000 | 20 |
| num | 每次请求数量 | 5-30 | 10 |

## ✨ 功能特点

### 1. 股票涨跌幅展示

每条新闻自动显示相关股票的实时涨跌幅：

```
相关行情
• 中煤能源
  ↑ +3.62%
• 物产中大
  ↑ +1.31%
```

**特点**：
- ✅ 红色上涨箭头 ↑
- ✅ 绿色下跌箭头 ↓
- ✅ 加粗显示关键数据
- ✅ 灰色显示股票代码

### 2. 分类标签

RSS的category字段包含：
- 股票名称 + 代码 + 涨跌幅
- 例如：`中煤能源(601898)+3.62%`

### 3. 时间特性

- **实时性强**：平均30秒/条新闻
- **时间跨度**：90条覆盖约35分钟
- **历史支持**：可通过分页获取历史数据

### 4. 数据完整性

**包含股票信息的新闻**：约65.6%
**平均每条新闻相关股票数**：约1.3个

## 📊 接口对比

| 特性 | `/sina/finance/724` | `/sina/zhibo` |
|------|---------------------|---------------|
| 数据源 | 移动端724 API | 网页端zhibo API |
| 股票信息 | ✅ 直接提供 | ✅ 需二次查询 |
| 股票代码 | ❌ 部分缺失 | ✅ 完整 |
| 涨跌幅格式 | `+3.62%` | `+3.62` |
| 实时性 | ✅ 很强（30秒/条） | ✅ 强（23秒/条） |
| 多媒体 | ❌ 不支持 | ✅ 支持图片/视频 |
| 历史数据 | ✅ 支持分页 | ✅ 支持分页 |
| 稳定性 | ✅ 移动端专用 | ✅ 网页端专用 |

## 🎯 使用场景

### 场景1：股票快讯监控

适合场景：需要实时监控股市相关新闻

```
GET /sina/finance/724/stock?limit=50
```

**优势**：
- 股票涨跌幅直接显示在Feed中
- 分类标签包含完整股票信息
- 无需额外API查询行情

### 场景2：综合财经监控

适合场景：全面了解财经动态

```
GET /sina/finance/724?limit=100
```

**优势**：
- 覆盖所有分类
- 时间跨度更长
- 数据量可控

### 场景3：移动端优化

适合场景：移动RSS阅读器

```
GET /sina/finance/724?num=20
```

**优势**：
- 移动端专用接口
- 数据格式简洁
- 加载速度快

## 📝 输出示例

### RSS结构

```xml
<item>
  <title>【中煤能源：第三季度净利润为47.8亿元，同比下降1.0%】...</title>

  <description>
    【中煤能源：第三季度净利润为47.8亿元...】

    相关行情
    • 中煤能源
      ↑ +3.62%
    • 中煤能源ADR
      ↓ 0.00%
  </description>

  <link>http://finance.sina.com.cn/focus/app/7x24_share.shtml?id=4457572</link>
  <guid>sina-724-4457572</guid>
  <pubDate>Mon, 27 Oct 2025 08:40:51 GMT</pubDate>
  <author>新浪财经</author>

  <category>中煤能源+3.62%</category>
  <category>中煤能源ADR0.00%</category>
</item>
```

### Description样式

```html
<p style="font-weight: bold; margin: 8px 0 4px 0;">相关行情</p>
<div style="margin: 6px 0;">
  • <strong>中煤能源</strong>
  <br>
  <span style="margin-left: 12px; color: #f5222d; font-weight: bold;">
    ↑ +3.62%
  </span>
</div>
```

## 🔧 技术细节

### API来源

```
https://news.cj.sina.cn/app/v1/news724/list
```

### 必需请求头

```http
User-Agent: sinafinance__9.0.1__iOS__{deviceid}__26.0.1__iPhone18,2
Cookie: genTime={timestamp}; vt=4; wm=b122
```

### 分页机制

使用ID分页：
1. 第1页：不传`id`参数
2. 第2页：传入上一页最后的`id`
3. 继续迭代...

### 设备ID

- 自动生成并缓存24小时
- 使用`crypto.randomBytes(16).toString('hex')`
- 确保请求连续性

## ⚠️ 注意事项

### 1. 股票代码缺失

部分股票没有`code`字段，只有`name`：
```json
{
  "name": "中煤能源",
  "code": "",  // 可能为空
  "range": "+3.62%"
}
```

**影响**：分类标签可能缺少代码

### 2. 涨跌幅格式

直接返回带`%`的字符串：
- `+3.62%`（上涨）
- `-1.23%`（下跌）
- `0.00%`（平盘）

**处理**：需要解析字符串判断涨跌方向

### 3. 请求频率

建议：
- 每次请求间隔 ≥ 0.5秒
- 避免短时间大量分页
- 使用合理的`num`参数（10-20）

### 4. 与zhibo的选择

**使用724的场景**：
- ✅ 需要直接获取股票涨跌幅
- ✅ 移动端优化需求
- ✅ 股票代码不重要

**使用zhibo的场景**：
- ✅ 需要多媒体内容（图片/视频）
- ✅ 需要完整股票代码
- ✅ 需要焦点新闻过滤

## 📈 性能数据

基于实际测试（90条新闻）：

| 指标 | 数值 |
|------|------|
| 时间跨度 | 35分钟 |
| 平均间隔 | 23秒/条 |
| 包含股票 | 65.6% |
| 股票总数 | 117个 |
| 响应时间 | <1秒 |

## 🚧 已知限制

1. **股票代码不完整**：部分股票缺少code字段
2. **无多媒体支持**：不包含图片/视频
3. **无焦点标记**：无法筛选重要新闻
4. **移动端专用**：需要特定User-Agent

## 🔄 更新日志

### 2025-10-27
- ✅ 初始版本发布
- ✅ 支持股票涨跌幅显示
- ✅ 支持分类筛选
- ✅ 支持分页获取历史数据
- ✅ 箭头样式优化（↑/↓）

## 📞 技术支持

### 相关路由

- `/sina/zhibo` - 网页端接口（支持多媒体）
- `/sina/finance/china` - 财经国内新闻
- `/sina/rollnews` - 滚动新闻

### 推荐搭配

**全面监控方案**：
```
1. /sina/finance/724 - 快讯+股票行情
2. /sina/zhibo - 多媒体内容
3. /jin10/flash - 金十数据快讯
```

**移动端方案**：
```
1. /sina/finance/724?num=20 - 主力快讯
2. /sina/zhibo?zhibo_id=focus - 焦点新闻
```

---

*最后更新: 2025-10-27*
*接口版本: v1*
*维护者: RSSHub社区*
