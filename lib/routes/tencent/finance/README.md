# 腾讯自选股财经快讯

## 路由说明

### `/tencent/finance/newslist/:filter?`

获取腾讯自选股的实时财经快讯。

#### 参数

- `filter`: 分类筛选（可选），默认为 `0`（全部）

#### 查询参数

- `limit`: 限制返回数量，默认 `20` 条

#### 示例

- `/tencent/finance/newslist` - 获取所有财经快讯（默认20条）
- `/tencent/finance/newslist?limit=50` - 获取50条财经快讯

## 特点

- 📱 **移动端专用接口** - 使用腾讯自选股移动端API
- 📊 **股票涨跌幅数据** - 包含相关股票的实时涨跌幅信息
- 🏷️ **热门标签分类** - 支持按热门标签分类（A股、港股、美股、宏观等）
- ⏱️ **实时性强** - 快讯更新及时
- 🔄 **历史数据分页** - 支持分页获取历史快讯

## 数据格式

### RSS Feed 包含

- **标题**: 提取【】内的关键信息
- **内容**: 
  - 主要内容区域（紫色边框）
  - 相关板块信息（蓝色边框，含涨跌幅）
  - 相关股票信息（绿色边框，含涨跌幅）
  - 来源信息
- **分类标签**: 
  - 新闻标签（如：A股、港股、宏观等）
  - 股票名称
- **发布时间**: 精确到秒的时间戳

### 股票信息展示

#### 相关板块
```
• 板块名称 (代码)
↑ +3.45%
```

#### 相关股票
```
• 股票名称 (代码)
↑ +2.15%  (上涨红色)
↓ -0.55%  (下跌绿色)
```

## API 说明

### 接口地址
`https://snp.tenpay.com/cgi-bin/snpgw_724_newslist.fcgi`

### 请求参数

| 参数 | 说明 | 示例 |
|------|------|------|
| `reserve` | 固定参数 | `2149056560` |
| `req_session` | 请求会话ID | 时间戳 |
| `zappid` | 应用ID | `zxg_h5` |
| `hot_label` | 是否返回热门标签 | `0`/`1` |
| `filter` | 分类筛选 | `0` |
| `limit` | 每页数量 | `10` |
| `offset` | 偏移量 | `0`, `10`, `20`... |
| `nonce` | 随机数 | 随机字符串 |
| `sign` | 签名 | MD5签名 |

### 签名算法

```javascript
// 1. 按key排序参数
// 2. 拼接为 key1=value1&key2=value2 格式
// 3. 添加密钥后缀
// 4. MD5加密
sign = MD5(queryString + "4f3fe9e2c2e04ce0a9c3e8f8c8d8e8f8")
```

### 热门标签

首次请求时设置 `hot_label=1` 可获取热门标签列表：

- **A股** (ID: 67)
- **美股** (ID: 69)
- **港股** (ID: 71)
- **宏观** (ID: 87)

## 技术实现

### 依赖

- `@/utils/got` - HTTP请求
- `@/utils/cache` - 缓存管理
- `@/utils/parse-date` - 日期解析
- `@/utils/timezone` - 时区转换
- `@/utils/md5` - MD5签名

### 核心流程

1. **分页获取新闻数据**
   - 首次请求获取热门标签
   - 循环分页直到达到limit或无更多数据

2. **批量获取股票行情**
   - 收集所有股票代码
   - 使用腾讯行情接口批量查询
   - 建立代码到行情的映射

3. **构建RSS内容**
   - 提取标题（【】内容）
   - 格式化正文（HTML）
   - 添加股票/板块信息
   - 生成分类标签

## 符合规范

本路由完全符合 `/Users/jasperl./Downloads/RSSHub-master-2/财经快讯RSS2.0格式规范.md` 的要求：

- ✅ 使用标准RSS 2.0格式
- ✅ 包含股票涨跌幅信息
- ✅ 区分板块和个股（蓝色/绿色边框）
- ✅ 使用标准配色方案（红涨绿跌）
- ✅ 提供分类标签
- ✅ 时间格式符合RFC 822标准

## 注意事项

1. **签名密钥**: 当前使用的签名密钥为 `4f3fe9e2c2e04ce0a9c3e8f8c8d8e8f8`，如API更新需要同步修改
2. **股票代码格式**: 腾讯股票代码格式为 `市场代码+股票代码`，如 `sh600519`（上海贵州茅台）
3. **分页限制**: API每页固定返回10条数据
4. **缓存策略**: 建议对股票行情数据进行短时缓存（5分钟）以减少请求

## 参考资料

- [API调试文档](../../../2025-10-28-175008.surgearchive/README.md)
- [财经快讯RSS2.0格式规范](../../../财经快讯RSS2.0格式规范.md)

